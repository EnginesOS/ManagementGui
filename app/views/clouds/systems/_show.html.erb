<% if defined?(state) && state %>
  <%= render '/clouds/systems/show/show_waiting_for_system', engines_system: engines_system, message: state %>
<% else %>
  <% begin %>
    <%= render '/clouds/systems/show/show', engines_system: engines_system %>
  <% rescue ActionView::Template::Error => e %>
    <% e = e.cause %>
    <% if e.class == EnginesError::EnginesError::ApiConnectionAuthenticationError %>
      <%= render '/clouds/systems/show/show_with_authentication_error', engines_system: engines_system, e: e %>
    <% elsif e.class == EnginesError::EnginesError::ApiRetryConnectionError %>
      <%= render '/clouds/systems/show/show_waiting_for_system', engines_system: engines_system, message: "Retrying connection." %>
    <% elsif e.class == EnginesError %>
      <%= render '/clouds/systems/show/show_with_error', engines_system: engines_system, e: e %>
    <% else %>
      <% raise e %>
    <% end %>
  <% end %>
<% end %>
